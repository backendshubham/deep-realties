<%- include('../layouts/main', { content: `
<!-- Hero Section -->
<section class="relative bg-gradient-to-b from-emerald-50 via-emerald-50/50 to-white dark:from-gray-900 dark:via-gray-900 dark:to-gray-900 py-12 sm:py-16 lg:py-20 overflow-hidden">
    <!-- Decorative Background Elements -->
    <div class="absolute inset-0 overflow-hidden pointer-events-none">
        <div class="absolute top-20 left-10 w-64 sm:w-96 h-64 sm:h-96 bg-emerald-100 dark:bg-emerald-900/10 rounded-full blur-3xl opacity-40"></div>
        <div class="absolute bottom-20 right-20 w-56 sm:w-80 h-56 sm:h-80 bg-emerald-50 dark:bg-emerald-900/20 rounded-full blur-3xl opacity-30"></div>
    </div>
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center relative z-10">
        <span class="badge-text inline-block px-3 sm:px-4 py-1.5 sm:py-2 bg-emerald-100 dark:bg-emerald-900/30 rounded-full mb-4 sm:mb-6 text-xs sm:text-sm border border-emerald-200 dark:border-emerald-800 text-emerald-700 dark:text-emerald-300">
            Our Projects
        </span>
        <h1 class="section-title text-3xl sm:text-4xl md:text-5xl lg:text-6xl mb-3 sm:mb-4 px-2">
            <span class="text-gray-900 dark:text-white">Our Projects</span>
        </h1>
    </div>
</section>

<div class="min-h-screen py-8">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        
        <div id="projectsGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- Projects will be loaded here -->
        </div>
    </div>
</div>

<script>
    async function loadProjects() {
        const response = await fetch('/api/projects');
        const data = await response.json();
        
        const grid = document.getElementById('projectsGrid');
        // Simple placeholder image as data URI (SVG) - using double quotes to avoid syntax errors
        const placeholderImage = 'data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%22400%22 height=%22300%22%3E%3Crect fill=%22%23e5e7eb%22 width=%22400%22 height=%22300%22/%3E%3Ctext x=%2250%25%22 y=%2250%25%22 dominant-baseline=%22middle%22 text-anchor=%22middle%22 font-family=%22Arial%22 font-size=%2218%22 fill=%22%239ca3af%22%3ENo Image%3C/text%3E%3C/svg%3E';
        
        if (data.projects && data.projects.length > 0) {
            grid.innerHTML = data.projects.map(function(project) {
                const projectImage = (project.images && project.images[0]) ? project.images[0] : placeholderImage;
                const statusClass = project.status === 'completed' ? 'bg-green-100 text-green-800' : project.status === 'ongoing' ? 'bg-blue-100 text-blue-800' : 'bg-yellow-100 text-yellow-800';
                return '<div class="bg-white dark:bg-gray-700 rounded-lg shadow-md overflow-hidden">' +
                    '<img src="' + projectImage + '" alt="' + project.name + '" class="w-full h-48 object-cover">' +
                    '<div class="p-4">' +
                        '<h3 class="text-xl font-semibold mb-2">' + project.name + '</h3>' +
                        '<p class="text-gray-600 dark:text-gray-400 mb-2">' + project.location + ', ' + project.city + '</p>' +
                        '<span class="px-3 py-1 rounded text-sm ' + statusClass + '">' +
                            project.status +
                        '</span>' +
                        '<a href="/projects/' + project.id + '" class="block mt-4 text-center px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg">' +
                            'View Details' +
                        '</a>' +
                    '</div>' +
                '</div>';
            }).join('');
        } else {
            grid.innerHTML = '<p class="col-span-full text-center">No projects available</p>';
        }
    }
    
    document.addEventListener('DOMContentLoaded', function() {
        // Hide loader immediately if page was restored
        if (typeof window.hidePageLoader === 'function') {
            window.hidePageLoader();
        }
        // Force hide loader element directly as backup
        const loader = document.getElementById('pageLoader');
        if (loader && loader.classList.contains('show')) {
            // Small delay to ensure pageshow handler has run
            setTimeout(function() {
                loader.classList.remove('show');
            }, 50);
        }
        loadProjects();
    });
    
    // Handle browser back/forward navigation
    window.addEventListener('pageshow', function(event) {
        if (event.persisted) {
            // Page was restored from cache (back/forward button)
            if (typeof window.hidePageLoader === 'function') {
                window.hidePageLoader();
            }
            // Force hide loader element directly
            const loader = document.getElementById('pageLoader');
            if (loader) {
                loader.classList.remove('show');
                loader.style.display = 'none';
            }
            // Reload projects data
            loadProjects();
        }
    });
</script>
` }) %>

